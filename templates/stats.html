<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Statistiche Interventi</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">

  <div class="container mt-5">

    <h1 class="mb-4 text-center">ðŸ“Š Statistiche Interventi</h1>

    <div class="row mb-4">
      <!-- cardsâ€¦ -->
    </div>

    <div class="row mb-5">
      <div class="col-md-6">
        <!-- qui salviamo i dati nei data-attributes -->
        <canvas id="risoltoChart"
                data-risolti="{{ risolti }}"
                data-non-risolti="{{ non_risolti }}"></canvas>
      </div>
      <div class="col-md-6">
        <canvas id="urgenzaChart"
                data-urgenti="{{ urgenti }}"></canvas>
      </div>
    </div>

    <div class="text-center">
      <a href="/" class="btn btn-secondary">â¬… Torna alla lista</a>
    </div>

  </div>

  <script>
    // Qui dentro ora Ã¨ *solo* JavaScript valido
    const risoltoEl = document.getElementById('risoltoChart');
    const risolti      = Number(risoltoEl.dataset.risolti);
    const nonRisolti   = Number(risoltoEl.dataset.nonRisolti);  // il dataset trasforma dashâ€‘case in camelCase

    const urgenzaEl    = document.getElementById('urgenzaChart');
    const urgenti      = Number(urgenzaEl.dataset.urgenti);

    // Pie chart risolti vs non risolti
    new Chart(risoltoEl.getContext('2d'), {
      type: 'pie',
      data: {
        labels: ['Risolti','Non Risolti'],
        datasets:[{ data: [risolti, nonRisolti] }]
      }
    });

    // Bar chart urgenze
    new Chart(urgenzaEl.getContext('2d'), {
      type: 'bar',
      data: {
        labels: ['Urgenze'],
        datasets:[{ label:'Numero Urgenti', data:[urgenti] }]
      },
      options:{ scales:{ y:{ beginAtZero:true } } }
    });
  </script>

</body>
</html>
